import os
from toolkit.settings_common import *

# environment values are passed in from docker

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        "NAME": os.environ.get("DB_NAME"),
        "USER": os.environ.get("DB_USER"),
        'PASSWORD': os.environ.get("DB_PASSWORD"),
        'HOST': os.environ.get("DB_HOST"), 
        'PORT': os.environ.get("DB_PORT"),
        'CONN_MAX_AGE': 10, # Allow DB connections to persist for 10 seconds
        'OPTIONS': {
            'init_command': "SET sql_mode='STRICT_TRANS_TABLES'",
        },
    }
}

# Make this unique, and don't share it with anybody.
SECRET_KEY = os.environ["SECRET_KEY"]

# Disable the log file
del LOGGING["handlers"]["file"]
LOGGING["loggers"]["toolkit"]["handlers"] = ["console"]

LOGGING["loggers"]["PIL"] = {"level": "INFO"}

# Instead enable logging to the console (configured in settings_common.py)
LOGGING['root'] = {
    "handlers": ["console", "mail_admins"],
    'level': 'DEBUG',
}

# The following are the lucky recipients of error emails
ADMINS = (
    # ('Your Name', 'your_email@example.com'),
    ('Ben Motz', 'ben@cubecinema.com'),
    ('Marcus Valentine', 'marcus@marcusv.org'),
)

SERVER_EMAIL = "toolkit_staging_errors@cubecinema.com"

SESSION_COOKIE_AGE = 3600
SESSION_EXPIRE_AT_BROWSER_CLOSE = False
SESSION_SAVE_EVERY_REQUEST = True

HTML_MAILOUT_ENABLED = True

# SECURE_SSL_REDIRECT = True
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
X_FRAME_OPTIONS = 'DENY'


EMAIL_HOST = os.environ["EMAIL_HOST"]
EMAIL_PORT = os.environ["EMAIL_PORT"]
EMAIL_HOST_USER = os.environ["EMAIL_HOST_USER"]
EMAIL_HOST_PASSWORD = os.environ["EMAIL_HOST_PASSWORD"]

CSRF_TRUSTED_ORIGINS = [
    "https://staging.cubecinema.com",
]
